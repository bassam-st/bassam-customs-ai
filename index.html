<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ù…Ø³Ø§Ø¹Ø¯ Ø¨Ø³Ø§Ù… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</title>
<style>
  body{font-family:system-ui;background:#f4f6f8;padding:16px;margin:0}
  .card{background:#fff;padding:16px;border-radius:16px;max-width:760px;margin:auto;box-shadow:0 4px 14px rgba(0,0,0,.08)}
  textarea,input{width:100%;padding:10px;margin:6px 0;font-size:16px;border:1px solid #d0d7de;border-radius:12px}
  button{padding:12px 14px;border:0;border-radius:12px;font-size:16px;cursor:pointer}
  .green{background:#16a34a;color:#fff;width:100%}
  .dark{background:#0f172a;color:#e5e7eb;padding:12px;border-radius:12px;white-space:pre-wrap}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .row button{flex:1}
  .admin{margin-top:16px;border-top:1px dashed #cbd5e1;padding-top:12px}
  .hidden{display:none}
  .hint{color:#475569;font-size:14px}
</style>
</head>
<body>

<div class="card">
  <h2>ğŸ›ƒ Ù…Ø³Ø§Ø¹Ø¯ Ø¨Ø³Ø§Ù… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</h2>

  <textarea id="q" placeholder="Ù…Ø«Ø§Ù„: ØµØ­ÙˆÙ† Ù†Øª 5 Ø­Ø¨Ø©
Ù…Ø«Ø§Ù„: Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø³ÙŠØ§Ø±Ø§Øª Ù…Ø³ØªØ®Ø¯Ù… 2000 ÙƒÙŠÙ„Ùˆ
Ù…Ø«Ø§Ù„: Ø¯Ø±Ø§Ø¬Ø© Ø£Ø·ÙØ§Ù„ 30 Ø­Ø¨Ø©"></textarea>

  <button class="green" id="ask">Ø§Ø­Ø³Ø¨ / Ø§Ø³Ø£Ù„</button>
  <pre id="out" class="dark">Ø¬Ø§Ù‡Ø²â€¦</pre>

  <div class="admin">
    <div class="row">
      <button id="toggleAdmin">âš™ï¸ Ø¥Ø¯Ø§Ø±Ø©</button>
      <button id="clearBtn">Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</button>
    </div>

    <div id="adminBox" class="hidden">
      <input id="pin" placeholder="PIN Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©">
      <button id="loginBtn">Ø¯Ø®ÙˆÙ„</button>

      <div id="panel" class="hidden">
        <h3>ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (JSON)</h3>
        <div class="hint">Ø§Ù„ØµÙ‚ Ù†ÙØ³ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙŠ Ø£Ø±Ø³Ù„ØªÙ‡Ø§ Ù„ÙŠ Ø¨ÙŠÙ† [ ] Ø«Ù… Ø§Ø¶ØºØ· â€œØ§Ø³ØªÙŠØ±Ø§Ø¯â€.</div>
        <textarea id="bulk" placeholder='Ø§Ù„ØµÙ‚ JSON Ù‡Ù†Ø§...'></textarea>
        <button id="importBtn" class="green">Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
        <pre id="adminOut" class="dark">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø§Ù‡Ø²Ø©.</pre>
      </div>
    </div>
  </div>
</div>

<script type="module">
  import { answer, adminLogin, importPriceList, clearCatalog } from "./engine/core.js";

  const out = document.getElementById("out");
  const q = document.getElementById("q");

  document.getElementById("ask").onclick = async ()=>{
    out.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";
    try{
      const r = await answer(q.value);
      out.textContent = r.text;
    }catch(e){
      out.textContent = "Ø®Ø·Ø£: " + e.message;
    }
  };

  const adminBox = document.getElementById("adminBox");
  const panel = document.getElementById("panel");
  const adminOut = document.getElementById("adminOut");

  document.getElementById("toggleAdmin").onclick = ()=> {
    adminBox.classList.toggle("hidden");
  };

  document.getElementById("loginBtn").onclick = ()=> {
    if(adminLogin(document.getElementById("pin").value)){
      panel.classList.remove("hidden");
      adminOut.textContent = "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ âœ…";
    } else {
      alert("PIN ØºÙŠØ± ØµØ­ÙŠØ­");
    }
  };

  document.getElementById("importBtn").onclick = ()=> {
    try{
      const raw = document.getElementById("bulk").value;
      const res = importPriceList(raw);
      adminOut.textContent = `ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ âœ…\nØ¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù: ${res.count}\nØ§Ù„Ø¢Ù† Ø¬Ø±Ù‘Ø¨ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø£ÙŠ ØµÙ†Ù + ÙƒÙ…ÙŠØ© + ÙˆØ­Ø¯Ø©.`;
    }catch(e){
      adminOut.textContent = "Ø®Ø·Ø£: " + e.message;
    }
  };

  document.getElementById("clearBtn").onclick = ()=> {
    if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© (Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©)ØŸ")){
      clearCatalog();
      out.textContent = "ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©.";
      adminOut.textContent = "ØªÙ… Ø§Ù„Ù…Ø³Ø­.";
    }
  };
</script>

</body>
</html>
